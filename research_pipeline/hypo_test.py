import asyncio
import httpx

ENDPOINT = "http://192.168.168.10:8000/generate_hypothesis"

async def main():
    # Три тестовых чанка (подставь свои реальные примеры)
    context_above = "All cold and temperate places become quite reliable for wheat, and the harvests are abundant. There are also some vines, but they are not very fruitful. Some say there is hope that soon vines will grow up in these regions and wine will be produced; indeed, that nearly all the fruits granted to Spain will also grow there. However, though no one easily gives up hope, it will nevertheless be in vain, and in my judgment, no such result is to be expected, nor will it ever appear: for the temperament of the air and the position of the sky are entirely contrary to ours. Moreover, when in New Spain and other places where the soil is better and milder, although vines have been planted, yet wine has not been gathered; how much less in the provinces of Peru. I also add that God, in His goodness, did not wish to grant such an excellent liquor to those brutish peoples, but only assigned them, according to their capacity and way of life, things necessary for sustaining life as best as possible. The Spaniards who established colonies there have plenty of radishes, lettuces, melons, cucumbers, and cabbages. Also lemons and oranges, although these fruits only grow in warm places. Figs moderately. There is almost a scarcity of livestock, due to continual wars; and when I was there, in Lima a single cow was valued at one hundred ducats, a sheep at fifty or sixty. The most fertile province of the Peruvian kingdom is Quito: it is very productive in grains, and also raises a great number of pigs and chickens of Spanish breed; moreover, it always abounds in a great supply of rabbits of most pleasant flavor. But wine is extremely expensive there. For in the city of Quito itself, when it is sold at the cheapest, a cask of wine, holding about twelve bottles (a bottle or jug, as they call it, holds twenty-eight ounces), is worth fourteen or fifteen ducats; in Lima and other coastal places, twelve; but in Potosi, an inland city more than five hundred miles from the sea, it commonly costs seventy or eighty ducats. In other places, according to the distance and situation of the region where it is imported, the price is higher or lower. But here new calamities often intervene, for since the casks or jars in which wine is brought from Spain are made of clay, when they are transported from place to place, they are often broken. Very often, too, when your ships are delayed for a long time, such a shortage of wine arises in those places that scarcely a single cask of the same kind can be bought for forty, five hundred, or even a thousand gold ducats. I will draw from Spanish writers some of their opinions relevant to this place. They have no certain knowledge from any writings or records of letters about the creation of the world up to the flood, but retain by memory what has been handed down by the Fathers. Namely, that a certain remarkable man (whom they call Contisp) once came from the north into those lands with extraordinary swiftness of foot, and, with his body bound by many bones of brothers or nephews, compelled them to move from the mountains to the plains and leveled the deep valleys, making a way for himself through everything. He is said to have begotten the men and women of those lands, and to have given them herbs and fruits of the forest."
    main_chunk = "He is said to have given life to those who were to be born. Soon, being offended by the Indians who cultivated the plain, he turned lands that were once fertile into barren sands, and deprived them of rains. He is said to have caused them to be swept up to higher ground by floods. Yet, for a better order of deaths, lest that region should lack living creatures, he opened springs and rivers, which the inhabitants used to irrigate their fields. This one, when the Sun and Moon were carried together, was once worshipped as the highest deity. Until another succeeded him, named Pachacama (which among them means Creator), who was himself born of the Sun and Moon, and far more powerful than the former. He is said to have approached Condin and disappeared: that by his art he transformed mortals created by the former into birds, monkeys, bears, lions, foxes, and other creatures; and that he created the ancestors of the Indians who now inhabit those lands, and taught them various ways of cultivating the earth and trees. Therefore, from that time, he was regarded as a god by them, received a temple and divine honors, and even now a province bears his name, only four leagues from Lima, where once the nobles of his kingdom, when they died, chose a burial place. Furthermore, Pachacaman is said to have lasted for many ages, until the Christians entered the Peruvian kingdom. From that time, he was never worshipped again. It is credible that he was a demon, who by such tricks deceived those wretched peoples; evidence for this is that before the arrival of the Christians, responses were commonly sought from the famous temple of Pachacama, as from a public oracle, which the demon, in human or other form, gave to the priests, who boasted of themselves. It is also commonly believed and still told among them, that a great flood once inundated the ancient lands, and that all mortals perished except a few, who, hidden in the caves of the highest mountains, with provisions and the entrances blocked with bundles, escaped the common fate. Moreover, when they sent out rains, they released two dogs; when they received them back wet and muddy, they judged that it was not yet time to go out, as the waters still covered everything. Soon after, when they sent them out again and saw them crawling about dirty and covered in mud, they realized that the waters had receded, and only mud remained; then, for certain reasons, they dared to emerge, but encountered a great number of serpents, which the muddy earth, cast up by the flood, had produced, and with great effort they cleared them away. Many also report another end of the world, but not before a great drought and, as it were, a conflagration of the air occurs, in which the Sun and Moon themselves will be consumed. Therefore, at eclipses of those stars, especially the Sun, they utter mournful cries and lamentations, believing that disaster and the end of things are at hand. What, I ask, are these traces of purer theology, which Satan could indeed erase from the minds of those nations in such barbarism? Among their strange customs, there were other absurdities, but especially this: that they would pour several cups of their liquor (which they call Chicha) into graves, or pour it through a reed that reached the mouth of the dead, or transfuse it. Moreover, they had a sense not only of the immortality of the soul, but also of the resurrection of bodies."
    context_below = """We learned that those peoples then, upon the arrival of our men, did what the Spaniards had just described: as they traveled, they opened tombs for gold and silver. Indeed, they begged them not to scatter the bones of the buried, so that those slain might rise again with less difficulty. (Aug. Zarat. Hist. Peru. book 1, chapter 12.) Of the Brazilian barbarians, Lerius writes thus: Not only, he says, do they believe in the immortality of the soul; but they also think that after death, the souls of those who had practiced virtue (which for them is abstaining from eating human flesh, while for others it is taking vengeance on enemies and eating as many as possible) fly over the highest mountains and join the souls of their ancestors and kin, and there, in the most pleasant gardens, spend eternity in delights and dances. On the other hand, the souls of the lazy, who lived ingloriously without any care for the propagation of their country, are carried off to Aignam (as they call a certain mountain) and there suffer eternal torments. (Navig. Brasil. chapter 16.) The Peruvian sheep, like camels (which, if you remove the humps, are almost identical in appearance), are sufficient for carrying heavy loads. The Spaniards had so accustomed them to riding that they could carry a rider for twelve or fifteen miles in a day. When tired from travel, they hurry to the river; but it is useless to try to fill them by force or by watering—they never drink unless they are thirsty. The livestock is truly profitable, both for meat and for their wool, which is of the best and finest quality, especially those they call Pacos. They are fed little, are extremely hardy, and can go four or five days without any food at all. (Aug. Zarat. Hist. Peru. book 3, chapter 2.) These inns or palaces, which they call Tambos, were built by Caniacava, the father of Atahualpa, mostly along the banks of rivers and royal roads, not only to provide supplies sufficient for the army on the march, but also arms, clothing, and every kind of weapon in such abundance that thirty thousand men could be fully equipped from them. Now it seems to me time to expose the false opinions those peoples have of us. After the Spaniards entered Peru, observed their customs, deeds, and the examples of atrocious cruelty everywhere owed to them, they never afterwards wanted to admit that we are Christians, sons of God (as they heard from the Spaniards), nor even that we were born as ordinary men are. Indeed, they thought it impossible that such a fierce and savage creature could be born of any man and woman. Thus, the belief took deep root in their minds that we were born from the sea; and so they call us Viracochas. (Cochie means sea among them, and Vira means foam. Therefore, they commonly say we are born and coagulated from sea foam, and nourished by it, and that we came to these lands to lay waste and destroy the world.) Nor could anyone, except Almighty God, remove that opinion from their minds. For they reason among themselves thus: Winds overthrow houses, break trees; fire has the same power; Viracochas devour everything, destroy the land, strike with lightning, and never cease; they are perpetually..."""

    payload = {
        "context_above": context_above,
        "main_chunk": main_chunk,
        "context_below": context_below,
    }

    async with httpx.AsyncClient(timeout=60) as client:
        response = await client.post(ENDPOINT, json=payload)
        if response.status_code == 200:
            print("Payload:")
            print(payload)
            data = response.json()
            print("Hypothesis:")
            print(data["hypothesis"])
            print("Confidence:", data["confidence"])
        else:
            print(f"Error {response.status_code}: {response.text}")

if __name__ == "__main__":
    asyncio.run(main())
